% =============================================================================
% File:  ulhpc_newsletter1.sty --  LaTeX style configuration for the document
% Author(s): Sebastien Varrette <Sebastien.Varrette@uni.lu>
% Creation:  16 Feb 2015
% Time-stamp: <Tue 2015-02-17 16:58 svarrette>
% 
% Copyright (c) 2015 Sebastien Varrette <Sebastien.Varrette@uni.lu> (see LICENCE)
% 
% Licence: Creative Commons Attribution-Noncommercial-Share Alike 2.0 France
% 
% You are free:
% - to Share:  to copy, distribute and transmit the work
% - to Remix: to adapt the work
% 
% Under the following conditions:
% - Attribution : You must attribute the work in the manner specified by the
% author or licensor (but  not in any way that suggests that
% they endorse you or your use of the work).
% - Noncommercial:  You may not use this work for commercial purposes.
% - Share Alike: If you alter, transform, or build upon this work, you may
% distribute the resulting work only under the same or similar
% license to this one.
% 
% With the understanding that:
% - Waiver: Any of the above conditions can be waived if you get permission
% from the copyright holder.
% - Other Rights: In no way are any of the following rights affected by the
% license:
% * Your fair dealing or fair use rights;
% * Apart from the remix rights granted under this license,
% the author's moral rights;
% * Rights other persons may have either in the work itself
% or in how the work is used, such as publicity or privacy
% rights.
% - Notice:  For any reuse or distribution, you must make clear to others the
% license terms of this work. The best way to do this is with a
% link to this web page.
% =============================================================================

\usepackage[hmargin=2cm,bmargin=3cm,tmargin=5cm,lmargin=6cm,centering]{geometry}

\usepackage[explicit]{titlesec}
\usepackage{tikzpagenodes}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.misc,arrows}
\usepackage{lmodern}
\usepackage{multicol}
\usepackage{lipsum}
\usepackage{atbegshi}
\usepackage{qrcode}

\usepackage[usenames]{colortbl}

\definecolor{lightgray}{gray}{0.9}
\definecolor{bcode}{rgb}{0.91,0.91,0.91}  % color for code extract
\definecolor{lightblue}{rgb}{0.45,0.76,0.98}  % color for
\definecolor{lightgray}{rgb}{.9, .9, .9}
\definecolor{lightgreen}{rgb}{.7, 1, .7}
\definecolor{darkgray}{rgb}{.4, .4, .4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{beamerblue}{rgb}{0.2,0.2,0.7}
\definecolor{textblue}{rgb}{0.16,0.32,0.85}
\definecolor{ulgray}{RGB}{92,92,92}
%\definecolor{ulblue}{red!70!green}
\definecolor{ulblue}{rgb}{0.0, 0.48, 0.65}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Versionning with day and time
%%%%%%%%%%%%%%
% months
\def\ftoday{\number\day\space
 \ifcase\month\or
 january\or february\or march\or april\or may\or june\or
 july\or august\or september\or october\or november\or december\fi
 \space\number\year}
% \isodayandtime to get current date and time
\begingroup
\count0=\time \divide\count0by60 % Hour
\count2=\count0 \multiply\count2by-60 \advance\count2by\time% Min
\def\2#1{\ifnum#1<10 0\fi\the#1}
\xdef\isodayandtime{\the\year-\2\month-\2\day\space\2{\count0}:%sec
\2{\count2}}
\endgroup

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Adapt section / subsection 
%%%%%%%%%%%%%%
\newcommand\titlebar{%
\tikz[baseline,trim left=0.5cm,trim right=2.5cm] {%
    \node [
        text = red!70!green,
        anchor= base east,
        minimum height=3.5ex] (a) at (2.5cm,0.6ex) {%
    };
   \path[fill=red!70!blue] (a.east) circle (.5ex);
   \draw[color=red!70!blue, thick,rounded corners=1ex] (a.east) |- (\textwidth+3cm,-0.75ex);
}
}

\newcommand\subtitlebar{%
\tikz[baseline,trim left=1cm,trim right=3.05cm] {%
    \node[
        text = red!70!green,
        anchor= base east,
        minimum height=3.5ex] (b) at (3.05cm,0.6ex) {%
    };
   \path[fill=red!70!blue] (b.east) circle (.5ex);
   \draw[color=red!70!blue, thick,rounded corners=1ex] (b.east) |- (\textwidth+2cm,-0.75ex);
}%
}

\titleformat{\subsection}{\normalfont\large\sffamily}{}{0cm}{\textcolor{ulblue}{#1}}
\titlespacing*{\subsection}{0cm}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{name=\subsection,numberless}{0cm}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\renewcommand*{\thesubsection}{\arabic{subsection}}
\titleformat{\section}{\LARGE\sffamily}{}{0cm}{\textcolor{ulblue}{#1}}
\titlespacing*{\section}{0cm}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{name=\section,numberless}{0cm}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\renewcommand*{\thesection}{\arabic{section}}

%%%%%%%%%%%%
\def\title{UL HPC Newsletter}
\def\ReleaseDate{February 2015}
\def\Number{1}
\def\InstituteURL{http://hpc.uni.lu}
\def\ReportSrcURL{https://github.com/ULHPC/documents}
\def\InstituteAddress{%
  University of Luxembourg          \\
  6, rue Richard Coudenhove-Kalergi \\
  L-1359 Luxembourg \\
  Luxembourg\\
  \textbf{T.} +352 46 66 44 6600
}
\def\Licence{CC BY-NC-SA 4.0}
\def\LicenceURL{http://creativecommons.org/licenses/by-nc-sa/4.0/}
\def\Editorsname{S. Varrette and Prof. P. Bouvry}
\def\NewsletterURL{http://hpc.uni.lu/newsletter}

%%%% Current version of the proposal
\IfFileExists{VERSION}{
  \def\docversion{\input{VERSION}}
}{
  \def\docversion{0.2}
}


\usepackage[plainpages=false]{hyperref}
\usepackage{breakurl}
\hypersetup{
  colorlinks=true,
  linkcolor=ulblue,
  urlcolor=ulblue,
  citecolor=ulblue,
  breaklinks,
  linktocpage=true,
  bookmarksopen,
  bookmarksopenlevel=1,
  bookmarksnumbered}


\newcommand\Header{%
  \begin{tikzpicture}[remember picture,overlay]
    \fill[ulgray]
    (current page.north west) -- (current page.north east) --
    ([yshift=50pt]current page.north east|-current page text area.north east) --
    ([yshift=50pt,xshift=-3cm]current page.north|-current page text area.north) --
    ([yshift=10pt,xshift=-5cm]current page.north|-current page text area.north) --
    ([yshift=10pt]current page.north west|-current page text area.north west) -- cycle;
    %
    % Logo UL HPC
    \node (logo_hpc)[xshift=0.8cm,yshift=-0.2cm,rounded corners,anchor=north west] at (current page.north west) {\includegraphics[width=4cm]{logo_ULHPC.pdf}};
    
    \node (header) [font=\sffamily\bfseries\color{white},anchor=east,xshift=-1.5cm,yshift=-1.5cm] at (current page.north east) {
      \fontsize{35}{60}\selectfont \title
    };
    
    \node (date) [font=\sffamily\bfseries\color{ulgray},anchor=east,yshift=1cm] at (current page text area.north east) {
      Issue \Number\ -- \ReleaseDate\  
      %-- \href{\NewsletterURL}{online version}
      
    };
    \node (qrcode)[font=\color{ulgray},anchor=south] at ($(current page text area.north east)+(1,0.3)$) { 
      \qrcode[version=3,height=1cm]{\NewsletterURL}
    };

 
    
  \end{tikzpicture}%
}


\newcommand\Left{%
  \begin{tikzpicture}[remember picture,overlay]
    \coordinate (up)   at   (current page text area.north west);
    \coordinate (down) at   (current page text area.south west);
    \coordinate (editors) at ($(current page text area.north west)+(-0.5,-0.2)$);
    \coordinate (toc)     at ($(editors)+(-0.2,-1.5)$);
    

    \draw [thick,color={ulgray}] ($(up)+(-0.5,0)$) -- ($(down)+(-0.5,0)$);  
    
    %fill=lightgray, rounded corners
    \node (docinfo)[font=\sffamily\color{ulgray},anchor=east, text width=5cm] at (editors) {
      \tiny
      \begin{tabular}{rp{3cm}}
        %\hline\\
        \textbf{Editors:}      & \Editorsname \\
        \textbf{Authors:}      & The UL HPC Management Team\\
        \textbf{Release date:} & \ReleaseDate  \\
        \textbf{Version:}      & v\docversion        \\
        %Compiled time:         & \isodayandtime \\
        %\hline
        \end{tabular}
        %      \textcolor{ulgray}{\textbf{Editors:} \Editors}
    };

    % TOC
    \node (toc_header)[font=\sffamily\color{ulblue},fill=lightgray,rounded rectangle west arc=none,anchor=east, inner sep=1em,text width=4.4cm] at (toc) {
      \fontsize{15}{50}\selectfont \textbf{In this issue...}
    };
    % \node (toc)[font=\sffamily\color{ulgray},anchor=east, text width=4.4cm,below=0.5 of toc_header] {
    %   %\InThisIssue
    %   %\printcontents[sections]{}{1}{}
    % };


    \node (logo_ul)[rounded corners, anchor=south,xshift=-3.25cm] at (current page text area.south west) {
      \includegraphics[width=3cm]{logo_UL.pdf}
    };
    \node (qrcode)[font=\color{ulgray},anchor=south,above=of logo_ul]  { 
      \qrcode[version=3]{\NewsletterURL}
    };


  \end{tikzpicture}%
}

\renewcommand\contentsname{}
\newcommand\ulhpctoc{
  \begin{tikzpicture}[remember picture,overlay]
    \node (toc)[font=\sffamily\color{ulblue},anchor=west, text width=5cm] at ($(current page.north west)+(0.1,-7.5)$) {
      \tableofcontents
    };
  \end{tikzpicture}
}

\newcommand\Footer{%
  \begin{tikzpicture}[remember picture,overlay]
    \fill[ulgray]
    (current page.south west) -- (current page.south east) --
    ([yshift=-40pt]current page.south east|-current page text area.south east) --
    ([yshift=-40pt,xshift=-3cm]current page.south|-current page text area.south) --
    ([xshift=-5cm,yshift=-10pt]current page.south|-current page text area.south) --
    ([yshift=-10pt]current page.south west|-current page text area.south west) -- cycle;

    \node[yshift=0.75cm,font=\ttfamily\bfseries\color{white}, anchor=east] at (current page.south east) {
      \fontsize{20}{24}\selectfont \href{\InstituteURL}{\color{white}{\InstituteURL}}~~~ 
    };

    \node (licence) [yshift=0.25cm, font=\sffamily\bfseries\color{white}, anchor=west] at (current page.south west) {
      \href{\LicenceURL}{\includegraphics[height=0.5cm]{logo_licence.png}}
      \tiny \LaTeX\ template by S. Varrette
    };
  \end{tikzpicture}%
}

\pagestyle{empty}
\AtBeginShipout{\Header\Left\Footer}
\AtBeginShipoutFirst{\Header\Left\Footer}

% \begin{document}
% \begin{multicols}{3}
%   \lipsum[1-15]
% \end{multicols}
% \end{document}



% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% eof
% 
% Local Variables:
% mode: latex
% mode: flyspell
% End:
